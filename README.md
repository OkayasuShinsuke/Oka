# Oka 日越音声翻訳（Webブラウザ版）

音声入力（または手動入力）を使って、**日本語 ↔ ベトナム語**を相互翻訳し、
- テキスト表示
- 音声読み上げ

をブラウザ上で行うサンプルです。

## 主な機能

- ブラウザでの音声入力モード（トグルで ON/OFF）
- 日本語入力時はベトナム語に翻訳 + 音声出力
- ベトナム語入力時は日本語に翻訳 + 音声出力
- 音声入力が難しい端末向けに手動入力も可能

## 1) PC側の設定手順

### 前提
- Node.js 18 以上（推奨 20+）
- PC とスマートフォンが同じ Wi-Fi に接続されていること

### セットアップ

```bash
npm install
npm start
```

起動後、`http://localhost:3000` でアクセスできます。

### ローカルネットワーク公開（スマホ接続用）

本アプリは `0.0.0.0` で待ち受けるため、PC のローカルIPでアクセスできます。

1. PC のローカル IP を確認
   - macOS/Linux: `ip a` または `ifconfig`
   - Windows: `ipconfig`
2. スマホから以下 URL にアクセス
   - `http://<PCのローカルIP>:3000`

例: `http://192.168.1.24:3000`

### PCで必要な追加設定（重要）

- ファイアウォールで `3000` ポートの受信を許可
- ブラウザでマイク利用を許可
- 翻訳先APIがブロックされる環境では `TRANSLATE_ENDPOINT` を変更

```bash
TRANSLATE_ENDPOINT=https://libretranslate.de/translate npm start
```

## 2) スマートフォン側の開始方法

## iPhone（Safari）

1. Safari で `http://<PCのIP>:3000` を開く
2. 初回アクセス時にマイク許可を「許可」
3. 画面上の「音声入力モード」を ON
4. 「音声入力開始」を押して話す
5. 画面に翻訳テキストが表示され、翻訳先言語で読み上げ

うまくいかない場合:
- iOS設定 → Safari → マイク で許可確認
- サイレントモード解除・音量確認
- 一度タブを閉じて再アクセス

## Android（Chrome）

1. Chrome で `http://<PCのIP>:3000` を開く
2. マイク権限を「許可」
3. 「音声入力モード」を ON
4. 「音声入力開始」を押して話す
5. 翻訳テキスト表示 + 音声出力

うまくいかない場合:
- Android設定 → アプリ → Chrome → 権限 → マイクを許可
- Chromeのサイト設定でマイク拒否になっていないか確認
- 省電力モードをOFF（バックグラウンド制限回避）

## 3) URLを他の人へ共有して使う方法

ローカルネットワーク内だけでなく、外部共有したい場合は HTTPS URL を使うのが安全です。

- 推奨: Cloudflare Tunnel / ngrok を使って HTTPS URL を発行
- 発行した URL を共有すれば、アプリインストール不要でブラウザ利用可能

> 注意: 一部ブラウザでは、音声認識（マイク入力）が `localhost` 以外では HTTPS を要求します。HTTP のローカルIPアクセスだと音声入力が動かない場合があります。その場合も手動入力は利用できます。

## 4) 運用時の注意

- 音声認識は Web Speech API 依存のため、端末・ブラウザ差があります
- 認識失敗時は手動入力ボタンで同じ翻訳フローを使えます
- デモ時は「翻訳API疎通」「マイク権限」「端末音量」を事前確認してください
